<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<!-- ğŸ”‘ QUESTO Ãˆ FONDAMENTALE -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<!-- <meta name="viewport" content="width=device-width, initial-scale=1.0">>-->
<title>Dashboard</title>
<link rel="stylesheet" href="style.css">
<link rel="apple-touch-icon" href="/icons/caloriferi-512.png">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Caloriferi">

<!-- <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">--->
</head>
<body>

<header class="topbar">
  <div class="topbar-left">
    <div class="logo">ğŸ”¥</div>
    <span class="app-name">Calore</span>
  </div>
  <div class="topbar-right">
    <button class="icon-btn active" onclick="location.href='index.html'">ğŸ </button>
    <button class="icon-btn" onclick="location.href='caloriferi.html'">â™¨ï¸</button>
    <button class="icon-btn" onclick="location.href='storico.html'">ğŸ•˜</button>
    <button class="icon-btn" onclick="location.href='grafici.html'">ğŸ“Š</button>
  </div>
</header>

<main class="container with-topbar">

  <!-- HEADER DASHBOARD -->
  <div class="dashboard-header">
    <div class="dashboard-title">
      <h1>Dashboard</h1>
      <p>Monitora i consumi dei tuoi caloriferi</p>
    </div>
    <div class="dashboard-action">
      <button class="btn-pill" onclick="apriSheet()">ï¼‹ Nuova Lettura</button>
    </div>
  </div>

  <!-- CARDS TOTALI -->
  <div class="card card-total">
    <div class="card-top">
      <span>Consumo Totale</span>
      <div class="icon">ğŸ”¥</div>
    </div>
    <div class="big-number" id="totaleConsumi">0</div>
    <span class="unit">unitÃ </span>
  </div>

  <div class="card card-small">
    <div>
      <span class="label">Caloriferi</span>
      <div class="small-number" id="numeroCaloriferi">0</div>
    </div>
    <div class="icon-gray">â™¨ï¸</div>
  </div>

  <div class="card card-small">
    <div>
      <span class="label">Letture</span>
      <div class="small-number" id="numeroLetture">0</div>
    </div>
    <div class="icon-gray">ğŸ“„</div>
  </div>

  <!-- CARD GRAFICO CONSUMI-->
  <div class="card">
    <h3>Andamento Consumi Mensili</h3>
    <canvas id="consumiChart" height="180"></canvas>
  </div>

  <!-- CARD CONSUMI PER STANZA -->
  <div class="card" id="consumiPerStanza">
    <h3>Consumi per Stanza</h3>
  </div>

  <!-- BACKUP -->
  <div class="card">
    <h3>Backup dati</h3>
    <button class="btn-pill full" onclick="backupDB()">
      ğŸ’¾ Esporta Backup
    </button>
    <br><br>
    <input type="file" id="restoreFile" accept=".json" style="display:none"
      onchange="ripristinaDB(this.files[0])">
    <button class="btn-pill full" style="background:#555"
      onclick="document.getElementById('restoreFile').click()">
      â™»ï¸ Ripristina Backup
    </button>
  </div>
</main>

<!-- OVERLAY NUOVA LETTURA -->
<div id="sheetOverlayLettura" class="sheet-overlay hidden" onclick="chiudiSheet()"></div>

<!-- SHEET NUOVA LETTURA -->
<div id="letturaSheet" class="sheet hidden">
  <div class="sheet-header">
    <h2>Nuova Lettura</h2>
    <button class="close-btn" onclick="chiudiSheet()">âœ•</button>
  </div>
  <div class="sheet-content">
    <label>Calorifero</label>
    <select id="letturaCalorifero"></select>

    <label>Valore</label>
    <input type="number" id="letturaValore" placeholder="Es: 123">

    <label>Data</label>
    <input type="date" id="letturaData">

    <button class="btn-pill full" onclick="salvaLettura()">Aggiungi</button>
  </div>
</div>

<!-- JS -->
<script src="app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="dashboard.js"></script>

</body>
</html>